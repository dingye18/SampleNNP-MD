#include "System.h"
#include <c_api.h>
#include <fstream>
#include <typeinfo>

using namespace std;
using namespace tensorflow;

void checkStatus(const tensorflow::Status& status) {
  if (!status.ok()) {
    std::cout << status.ToString() << std::endl;
    exit(1);
  }
}

#define VALUETYPE float

unsigned int natoms = 12;
unsigned int nghost = 0;
int nsteps = 1000;
// Force and energy coefficients are used for units transformation from {eV/A, eV} to {kJ/(mol * nm), kJ/mol}.
double dener = 0., forceUnitCoeff = 964.8792534459, energyUnitCoeff = 96.48792534459;
double delta_T = 0.0001; // 0.0001 picoseconds here.

vector<VALUETYPE> dcoord = vector<VALUETYPE>(natoms * 3);
vector<int> dtype = {0,1,1,0,1,1,0,1,1,0,1,1};
vector<VALUETYPE> dbox = {20.0,0.0,0.0,0.0,20.0,0.0,0.0,0.0,20.0};
vector<VALUETYPE> dforce = vector<VALUETYPE>(natoms * 3, 0.);
vector<VALUETYPE> dvirial = vector<VALUETYPE>(9, 0.);
vector<Vec3> xPrime = vector<Vec3>(natoms, Vec3());


void update(double delta_T, System& system, int step){
    // Update the velocities and positions of each particle with Verlet Integrator.
    // Get new velocities first.
    for(int ii=0; ii < natoms; ii++){
        for(int jj=0; jj < 3; jj++){
            system.velocities[ii][jj] += static_cast<double>(dforce[ii * 3 + jj]) * forceUnitCoeff * system.atoms[ii].inverseMass * delta_T;
            xPrime[ii][jj] = system.positions[ii][jj] + system.velocities[ii][jj] * delta_T;
        }
    }
    // Update the positions
    for(int ii=0; ii < natoms; ii++){
        for(int jj = 0; jj < 3; jj++){
            system.velocities[ii][jj] = 1.0/delta_T * (xPrime[ii][jj] - system.positions[ii][jj]);
            system.positions[ii][jj] = xPrime[ii][jj];
        }
    }

    // Calculate the kinetic energy.
    vector<Vec3> shiftedVelocity = vector<Vec3>(natoms, Vec3());
    double kinetic = 0.;
    for(int ii = 0; ii < natoms; ii ++){
        for(int jj = 0; jj < 3; jj++){
            shiftedVelocity[ii][jj] = system.velocities[ii][jj] + static_cast<double>(dforce[ii * 3 +jj])* forceUnitCoeff * 0.5 * delta_T * system.atoms[ii].inverseMass;
            kinetic +=  system.atoms[ii].mass * shiftedVelocity[ii][jj] * shiftedVelocity[ii][jj];
        }
    }
    kinetic = 0.5 * kinetic;
    system.kinetic_energy.push_back(kinetic);
    system.total_energy.push_back(kinetic + dener * energyUnitCoeff);
}

void step(double delta_T, NNPInter nnp_inter, System& system, int step){
    for(int ii=0; ii < natoms; ii++){
        // Multiply 0.1 for unit transformation from nanometers to angstrom.
        dcoord[ii * 3 + 0] = static_cast<float>(system.positions[ii][0]) * 10;
        dcoord[ii * 3 + 1] = static_cast<float>(system.positions[ii][1]) * 10;
        dcoord[ii * 3 + 2] = static_cast<float>(system.positions[ii][2]) * 10;
    }
    nnp_inter.compute(dener, dforce, dvirial, dcoord, dtype, dbox, nghost);
    system.potential_energy.push_back(dener * energyUnitCoeff);
    update(delta_T, system, step);
}


int main(){
    string model = "../model/lw_pimd.smooth.pb";
    string OP_library  = "/home/dingye/.local/deepmd-kit-1.2.0/lib/libdeepmd_op.so";
    TF_Status* LoadOpStatus = TF_NewStatus();
    TF_LoadLibrary(OP_library.c_str(), LoadOpStatus);
    TF_DeleteStatus(LoadOpStatus);         
    cout.precision(10);
    
    
    double init_coords[] = {10.543000221252441, 14.571999549865723,7.9380002021789551,10.170000076293945,15.211000442504883,7.3270001411437988,11.420999526977539,14.894000053405762,8.116999626159668,3.4600000381469727,6.3179998397827148,1.784000039100647,2.7950000762939453,6.4429998397827148,1.1039999723434448,3.5339999198913574,5.3730001449584961,1.878000020980835,1.3240000009536743,14.984000205993652,5.8090000152587891,1.6160000562667847,15.803000450134277,6.2129998207092285,0.47200000286102295,15.189999580383301,5.434999942779541,3.9010000228881836,18.275999069213867,0.55199998617172241,3.684999942779541,18.003000259399414,1.4450000524520874,3.5929999351501465,17.562999725341797,0.0010000000474974513};

    // Used for 216 water molecules.
    //double init_coords[] = {3.296,4.834,7.952,3.249,5.79,7.971,2.6,4.548,8.543,12.567,4.527,1.065,11.623,4.652,1.17,12.913,4.557,1.957,2.855,0.926,17.779,3.336,1.659,18.163,1.947,1.068,18.046,15.83,1.87,16.718,15.536,2.76,16.523,15.079,1.457,17.143,11.102,12.81,0.365,10.586,13.53,0.727,12.001,13.002,0.629,2.167,15.558,7.784,1.914,15.059,8.561,1.902,16.457,7.979,16.733,8.824,14.085,15.856,8.881,14.465,16.583,8.602,13.166,18.841,4.626,8.271,18.772,4.177,9.113,18.035,5.137,8.205,5.057,10.606,15.241,6.009,10.71,15.225,4.897,9.792,14.763,11.483,16.787,16.062,11.862,16.329,15.311,11.878,16.365,16.825,17.434,2.628,13.678,16.541,2.81,13.972,17.619,1.747,14.003,2.56,11.18,13.607,3.433,10.819,13.758,2.703,11.912,13.007,11.377,17.275,2.19,10.422,17.223,2.169,11.669,16.556,1.63,15.729,2.537,1.959,15.816,2.359,1.022,16.171,3.377,2.085,13.503,14.179,11.633,13.12,13.457,11.134,14.346,13.84,11.936,16.382,4.25,5.156,16.252,4.366,4.215,16.489,3.306,5.269,1.392,6.588,4.22,2.308,6.576,3.941,1.277,5.768,4.699,7.173,4.961,1.638,7.009,5.258,0.742,7.122,4.007,1.588,8.538,18.871,13.057,8.758,18.012,12.695,9.232,19.05,13.691,15.481,15.786,15.836,16.053,15.446,15.149,16.073,16.002,16.557,9.872,16.348,11.805,10.707,16.116,11.398,9.617,15.564,12.292,15.827,0.154,8.535,14.894,-0.059,8.506,15.991,0.623,7.717,2.501,8.744,10.339,3.031,9.541,10.366,1.602,9.049,10.462,7.196,13.647,1.03,7.386,12.709,1.038,6.377,13.721,0.54,14.932,12.223,13.051,14.2,12.211,13.667,15.703,12.047,13.59,12.267,1.005,11.052,11.992,0.088,11.069,12.663,1.152,11.911,4.101,17.222,10.94,4.5,18.001,11.326,3.283,17.107,11.424,7.706,11.177,14.789,7.833,12.081,15.078,7.412,11.254,13.882,12.561,14.828,5.036,12.578,15.536,5.679,11.655,14.803,4.729,14.277,15.181,3.03,13.694,15.032,3.775,15.156,15.185,3.409,8.349,13.865,7.259,8.831,13.793,6.435,8.933,13.48,7.913,4.052,6.285,11.066,3.493,7.009,11.348,4.759,6.705,10.576,8.49,17.497,2.461,7.998,16.677,2.477,7.897,18.125,2.048,11.332,8.282,1.36,10.897,8.588,2.157,10.852,7.492,1.114,4.609,17.97,6.54,4.585,18.734,7.116,5.096,17.312,7.035,2.922,13.948,5.652,2.827,14.497,6.43,3.523,13.253,5.92,2.139,6.787,13.497,1.467,6.995,14.145,2.044,5.846,13.347,11.129,7.776,6.6,10.329,8.298,6.667,11.787,8.284,7.075,16.327,18.114,4.657,16.544,17.186,4.744,15.445,18.121,4.284,4.665,0.799,3.688,5.477,1.268,3.877,4.561,0.195,4.423,2.733,8.311,0.217,3.625,8.481,-0.085,2.662,7.357,0.229,0.658,9.574,17.264,1.058,10.306,16.795,1.264,9.389,17.982,9.928,8.687,3.683,9.741,7.883,4.168,9.329,9.336,4.054,12.939,11.716,15.128,12.23,12.301,15.393,13.608,11.828,15.803,12.249,15.399,13.818,11.823,14.659,14.251,12.417,15.092,12.927,5.645,17.591,13.802,5.712,18.131,14.589,6.215,18.022,13.165,1.613,16.654,12.162,1.545,17.603,12.267,1.982,16.346,12.99,7.241,2.896,14.461,7.759,2.334,13.885,6.985,3.634,13.908,6.799,11.553,6.268,7.584,11.667,5.732,6.697,12.389,6.724,11.631,1.994,7.025,11.768,1.346,6.334,10.706,1.906,7.255,15.891,10.485,7.998,15.624,11.32,7.615,15.548,10.51,8.892,1.373,0.907,5.933,2.027,1.593,5.796,1.625,0.496,6.76,10.102,1.988,14.808,10.183,2.876,14.461,10.91,1.849,15.302,17.581,15.302,14.334,18.213,14.765,13.857,18.115,15.836,14.922,13.202,0.45,8.628,12.624,0.88,7.998,13.037,0.904,9.454,13.038,10.349,6.649,13.794,10.036,7.147,13.338,11.162,6.244,14.603,9.52,-0.243,14.252,8.681,0.055,15.464,9.581,0.169,16.701,8.313,6.5,17.527,8.638,6.144,16.407,9.004,7.094,2.463,10.305,1.912,2.716,11.078,1.408,2.648,9.567,1.331,12.482,12.203,9.872,13.063,11.474,10.089,12.956,12.696,9.202,5.813,4.738,13.055,6.381,5.507,13.089,4.971,5.076,12.748,7.974,13.993,15.626,7.348,14.42,15.041,8.32,14.703,16.166,8.89,5.534,17.158,9.617,5.841,16.616,9.091,4.614,17.33,13.806,13.363,1.09,14.752,13.293,0.961,13.707,13.993,1.804,13.695,18.296,3.548,12.898,17.886,3.213,13.545,19.235,3.44,3.989,17.645,1.403,4.133,18.145,2.206,3.569,18.264,0.806,13.333,14.98,17.38,13.616,14.218,17.885,14.126,15.281,16.936,4.267,14.903,16.33,4.899,14.821,15.615,4.785,15.202,17.076,13.055,4.884,4.017,12.416,5.573,3.836,13.753,5.324,4.503,4.312,2.145,13.185,4.043,1.365,13.671,5.15,2.393,13.574,14.692,3.875,13.325,14.241,4.554,12.822,14.841,4.271,14.183,3.66,2.697,1.881,3.983,1.975,2.419,3.081,3.189,2.463,11.842,4.909,16.099,11.43,4.278,16.69,11.486,4.697,15.236,2.35,4.202,10.915,2.28,4.137,11.867,2.861,4.998,10.766,3.834,12.334,17.128,4.238,11.734,16.501,4.097,13.205,16.831,14.428,10.925,3.35,15.17,10.497,2.925,13.764,10.239,3.421,17.945,13.167,16.559,18.789,12.747,16.394,17.999,14.005,16.099,14.359,12.833,5.586,14.406,12.288,4.8,13.632,13.433,5.419,5.003,10.118,2.393,5.179,9.177,2.397,4.067,10.185,2.201,0.117,16.802,16.21,-0.39,17.565,15.932,-0.126,16.675,17.127,1.37,18.204,3.224,2.237,17.821,3.088,1.326,18.369,4.166,2.402,5.535,18.906,1.567,5.092,18.758,2.915,5.35,18.119,17.922,11.579,11.542,17.526,11.509,12.41,17.479,12.325,11.136,14.376,16.623,0.574,14.285,16.246,1.449,14.039,15.947,-0.014,5.362,13.125,9.518,6.146,13.579,9.827,5.291,13.369,8.595,9.292,17.089,5.107,9.112,17.614,5.886,8.798,17.518,4.409,0.589,14.343,4.236,0.781,15.258,4.03,1.31,14.068,4.802,4.84,6.695,5.908,4.321,6.838,6.699,4.85,5.744,5.796,17.771,0.19,1.595,18.516,0.072,2.185,17.037,0.395,2.173,10.25,6.914,13.346,9.778,7.416,14.011,11.119,7.314,13.316,3.303,4.961,16.163,3.471,5.642,15.511,2.408,4.673,15.985,1.432,11.773,15.982,1.779,11.606,15.105,2.198,12.017,16.501,15.136,12.109,16.653,15.353,11.485,17.346,15.938,12.616,16.527,0.637,13.678,12.849,1.588,13.768,12.794,0.468,12.767,12.607,5.588,7.574,18.377,5.853,7.48,17.462,6.296,8.076,18.782,7.533,6.757,6.054,6.584,6.875,6.019,7.855,7.533,6.513,7.32,3.282,11.197,7.443,3.884,10.464,6.706,3.732,11.777,7.58,2.062,7.175,6.805,2.256,7.702,8.057,2.891,7.134,9.182,8.212,15.503,9.822,8.365,16.198,8.895,9.088,15.244,5.986,7.549,2.693,6.528,6.827,2.374,6.312,7.722,3.576,8.069,16.894,9.781,8.887,16.807,10.27,7.76,17.777,9.984,9.578,15.012,0.857,9.514,15.361,-0.032,8.737,14.581,1.007,2.726,0.367,14.87,2.731,0.447,15.824,2.655,-0.574,14.708,10.119,5.125,1.716,10.004,4.758,2.593,9.307,5.603,1.548,11.068,5.113,6.394,11.162,6.053,6.549,11.835,4.723,6.813,1.16,14.706,10.24,1.403,15.429,10.82,0.864,14.014,10.831,3.098,7.544,7.772,3.014,7.948,8.636,2.515,8.056,7.211,16.688,15.327,4.649,16.452,15.205,5.569,17.557,14.932,4.57,4.621,10.642,9.845,4.864,10.27,8.998,4.702,11.588,9.723,7.806,14.174,10.67,8.621,13.941,10.226,7.562,15.02,10.295,13.691,0.921,18.509,13.845,-0.01,18.671,12.915,1.13,19.029,7.304,0.371,0.512,8.032,0.325,-0.107,6.74,1.065,0.169,15.092,7.186,4.317,14.429,7.862,4.181,15.787,7.626,4.807,18.657,1.194,17.617,18.235,0.613,18.25,18.383,0.858,16.763,18.263,11.805,6.063,19.145,11.516,5.83,17.704,11.454,5.37,8.077,10.438,9.146,8.091,10.217,10.077,7.209,10.815,9.001,12.62,8.836,8.995,13.253,9.23,9.595,12.45,9.516,8.343,2.245,4.111,13.536,2.849,3.374,13.623,1.608,3.985,14.239,0.996,8.628,5.979,1.112,9.413,5.444,0.977,7.909,5.348,-0.458,6.631,1.808,-0.281,5.734,1.523,0.067,6.738,2.601,12.87,16.383,7.162,13.808,16.196,7.115,12.81,17.334,7.08,5.473,16.323,8.828,5.012,16.512,9.645,6.397,16.455,9.038,16.403,5.746,7.446,16.376,6.633,7.088,16.465,5.178,6.678,12.703,8.737,4.235,12.585,9.153,5.089,11.813,8.56,3.929,13.585,5.841,11.778,12.896,5.613,11.154,14.376,5.918,11.245,13.371,2.339,2.981,13.026,3.15,3.353,14.223,2.584,2.619,9.147,18.634,7.706,8.516,19.302,7.438,8.779,18.265,8.508,17.064,1.669,6.102,17.949,1.536,6.443,16.945,0.965,5.464,8.988,9.328,6.908,8.652,9.693,7.726,9.111,10.087,6.338,11.638,5.104,10.185,11.179,4.35,10.555,12.115,4.75,9.434,5.759,14.958,14.269,5.779,14.404,13.488,5.611,15.842,13.932,17.634,18.453,10.509,16.982,18.617,9.828,17.337,17.65,10.937,14.761,10.193,10.533,14.798,10.75,11.31,15.316,9.443,10.748,9.856,14.345,4.727,9.663,14.065,3.832,9.556,15.253,4.765,1.297,3.248,3.263,1.136,3.754,4.06,1.679,2.427,3.574,6.114,7.304,9.717,6.586,6.546,9.373,6.058,7.908,8.976,6.689,10.57,12.185,7.43,9.977,12.065,5.989,10.189,11.655,14.79,4.357,16.007,15.214,4.859,16.703,13.89,4.683,15.989,8.076,5.284,9.397,8.36,4.935,8.552,8.793,5.854,9.674,0.706,3.697,15.595,0.816,2.848,16.023,-0.203,3.7,15.297,2.676,12.719,0.914,2.778,13.605,1.261,3.125,12.739,0.068,9.735,12.602,9.339,9.37,11.718,9.315,10.678,12.471,9.437,8.285,0.332,16.425,8.814,0.769,15.757,7.392,0.632,16.258,16.793,13.457,0.43,17.19,13.356,-0.435,17.419,13.054,1.031,4.411,8.347,13.814,3.66,7.772,13.668,5.107,7.977,13.271,13.843,7.058,0.637,13.725,6.134,0.855,12.956,7.418,0.632,6.936,7.431,12.479,7.887,7.369,12.397,6.62,7.501,11.578,16.758,16.144,11.69,17.383,16.13,12.415,15.991,16.593,12.043,11.851,7.533,16.833,11.898,6.634,16.507,12.106,8.073,16.084,2.734,15.188,1.945,2.78,16.1,1.66,3.172,15.179,2.796,8.723,4.481,6.851,9.671,4.508,6.717,8.411,5.327,6.529,13.117,4.056,8.151,14.06,3.989,8.302,12.899,3.276,7.641,11.515,9.996,12.861,11.94,10.65,13.417,12.205,9.362,12.666,16.222,8.039,11.299,16.068,7.205,10.854,17.111,8.285,11.046,3.002,1.775,10.069,2.945,2.707,10.282,2.596,1.334,10.814,10.044,3.242,4.098,10.599,2.506,4.355,10.268,3.938,4.716,10.773,13.406,15.888,10.865,13.779,16.765,9.878,13.623,15.627,3.204,13.378,12.117,3.229,13.473,11.165,4.124,13.367,12.381,8.518,7.658,0.45,9.008,8.448,0.226,8.608,7.094,-0.318,15.94,5.486,10.132,16.249,4.613,10.374,16.105,5.546,9.191,17.409,11.422,14.186,17.553,11.783,15.061,17.246,10.491,14.335,5.703,1.065,16.085,6.121,1.903,15.886,5.25,1.213,16.915,0.654,4.426,5.693,0.825,4.404,6.635,-0.288,4.276,5.616,11.456,1.297,1.459,12.095,1.799,1.964,11.544,0.401,1.784,1.9,10.916,4.734,1.946,10.536,3.857,2.814,11.014,5.001,17.181,9.006,0.622,17.584,8.167,0.845,17.837,9.453,0.086,9.776,11.604,2.6,10.646,11.567,2.203,9.172,11.584,1.857,17.54,13.694,7.946,18.34,13.776,8.466,17.755,13.046,7.275,17.454,16.511,-0.026,17.24,17.147,0.656,17.202,15.666,0.346,17.177,0.024,15.126,16.579,0.587,15.617,16.622,-0.408,14.478,14.655,9.084,15.603,14.813,9.009,16.544,14.109,9.866,15.513,5.701,14.255,7.151,5.435,14.961,7.741,6.658,14.281,7.161,18.727,4.162,1.026,18.948,3.786,1.877,18.524,3.406,0.474,17.184,10.076,3.321,17.523,10.711,2.689,17.66,9.268,3.127,15.665,5.391,2.495,15.456,6.104,3.099,16.307,5.768,1.893,7.534,11.046,1.181,8.026,10.35,0.745,6.632,10.727,1.2,16.33,13.668,10.564,16.267,14.621,10.631,16.619,13.509,9.666,7.178,0.957,9.944,6.576,1.12,9.219,7.143,1.757,10.469,12.353,1.067,16.007,12.71,1.137,16.892,12.12,0.143,15.914,9.981,2.769,17.693,9.667,1.933,17.349,10.348,2.553,18.551,0.087,12.419,2.222,0.074,13.102,2.893,0.829,12.647,1.663,13.605,1.406,13.575,13.245,1.386,14.461,13.971,2.285,13.483,6.361,7.409,15.759,7.191,7.784,15.464,5.692,7.912,15.295,1.813,0.845,12.222,0.871,0.911,12.376,2.196,0.778,13.097,9.978,7.206,10.107,10.613,6.591,10.473,10.432,7.608,9.366,5.445,15.591,-0.103,6.285,15.897,0.239,4.79,16.09,0.385,5.06,1.78,8.142,4.617,1.799,8.99,4.378,2.008,7.51,4.669,4.213,4.612,5.376,3.742,4.17,4.269,4.746,3.925,12.021,18.537,5.534,11.212,18.141,5.208,12.65,18.416,4.823,17.124,3.31,10.836,17.421,3.168,11.735,16.991,2.43,10.485,3.807,5.715,2.603,4.529,6.335,2.503,3.458,5.609,1.717,18.366,9.444,10.019,18.479,10.246,10.528,18.302,9.742,9.111,15.983,5.937,17.768,16.389,6.692,17.342,15.357,6.317,18.384,1.424,0.047,8.673,0.84,-0.333,9.329,1.877,0.752,9.135,5.857,4.332,17.004,4.996,4.677,16.766,6.478,4.931,16.589,0.322,7.697,15.276,-0.393,8.142,14.822,0.448,8.204,16.078,5.56,2.302,-0.009,5.725,3.02,-0.62,5.017,2.691,0.677,2.476,16.215,14.668,3.181,15.743,15.113,1.764,16.241,15.307,13.929,13.603,8.216,14.205,13.437,7.314,14.281,14.47,8.419,4.471,11.017,5.156,5.326,11.27,5.503,4.598,10.976,4.208,6.051,13.267,12.377,6.151,12.324,12.249,6.845,13.646,11.998,9.406,11.664,5.232,9.808,12.517,5.394,9.494,11.533,4.288,5.783,9.099,7.539,4.995,8.731,7.138,6.069,9.777,6.928,3.318,2.713,6.178,3.713,3.257,5.497,3.047,3.334,6.854,14.557,17.391,12.763,14.079,16.881,13.416,14.154,18.259,12.795,12.22,16.36,10.38,12.969,15.872,10.722,12.331,16.335,9.43,12.891,7.739,13.781,13.603,7.982,14.373,13.311,7.202,13.109,6.977,2.369,4.356,7.776,2.75,3.992,7.175,2.235,5.283,9.116,16.2,17.183,9.867,16.373,16.616,8.612,17.013,17.169,10.418,3.057,11.246,10.926,2.246,11.238,9.506,2.77,11.218,10.655,4.35,13.718,10.473,5.275,13.553,10.466,3.917,12.885,9.838,10.12,18.1,9.961,11.041,18.33,10.622,9.683,18.431,9.006,9.484,11.502,9.303,8.674,11.087,9.791,9.843,11.916,4.109,15.968,4.38,3.687,15.244,4.843,4.462,16.524,5.074,6.591,15.41,2.963,5.745,15.414,3.409,6.553,14.649,2.383,15.722,15.922,7.7,16.364,15.213,7.735,16.107,16.62,8.23}
    
    NNPInter nnp_inter = NNPInter(model, 0);
    System sys = System(natoms);

    for(unsigned int ii = 0; ii < natoms; ii ++){
        string symbol = "";
        double mass = 0.;
        if(dtype[ii] == 0){
            symbol = "O";
            mass = 15.999;
        }
        else if(dtype[ii] == 1){
            symbol = "H";
            mass = 1.00784;
        }    
        sys.atoms.push_back(atom(ii, dtype[ii], symbol, mass));
        sys.positions.push_back(Vec3(init_coords[ii * 3 + 0] * 0.1, init_coords[ii * 3 + 1] * 0.1, init_coords[ii * 3 + 2] * 0.1));
        sys.velocities.push_back(Vec3(0., 0., 0.));
    }
    /*
    sys.kinetic_energy = vector<double>(steps, 0.);
    sys.potential_energy = vector<double>(steps, 0.);
    sys.total_energy = vector<double>(steps, 0.);
    */
   
    //nnp_inter.compute(dener, dforce, dvirial, dcoord, dtype, dbox, nghost);

    for(int ii = 0; ii < nsteps; ii ++){
        step(delta_T, nnp_inter, sys, ii);
        cout<< ii + 1 << " step (unit is kJ/mol): "<<endl;
        cout<<"Kinetic Energy: "<<sys.kinetic_energy.back()<<" ";
        cout<<"Potential Energy: "<<sys.potential_energy.back()<<" ";
        cout<<"Total Energy: "<<sys.total_energy.back()<<endl;
        cout<<"----------------------"<<endl;
    }

    return 0;
}

